---
phase: 05-results-polish
plan: 05
type: execute
wave: 3
depends_on: ["05-04"]
files_modified:
  - notebooks/quickstart.ipynb
  - notebooks/optimization.ipynb
  - notebooks/visualization.ipynb
autonomous: true

must_haves:
  truths:
    - "User can run quickstart notebook end-to-end without modification"
    - "Quickstart demonstrates data loading, simulation, and basic results"
    - "Optimization notebook demonstrates budget-constrained intervention selection"
    - "Visualization notebook demonstrates all 4 chart types with SDK theme"
    - "Notebooks include synthetic data generation (no external files needed)"
    - "Notebooks are tutorial-style with explanatory markdown"
  artifacts:
    - path: "notebooks/quickstart.ipynb"
      provides: "End-to-end quickstart tutorial"
      min_lines: 150
    - path: "notebooks/optimization.ipynb"
      provides: "Optimization workflow tutorial"
      min_lines: 100
    - path: "notebooks/visualization.ipynb"
      provides: "Visualization and export tutorial"
      min_lines: 100
  key_links:
    - from: "notebooks/quickstart.ipynb"
      to: "asset_optimization"
      via: "import and use SDK"
      pattern: "from asset_optimization import"
---

<objective>
Create Jupyter notebook examples demonstrating SDK end-to-end workflows

Purpose: Provide users with runnable, educational examples (DEVX-03, DEVX-04 partial)
Output: 3 focused notebooks: quickstart, optimization, visualization
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-results-polish/05-CONTEXT.md

@src/asset_optimization/__init__.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create quickstart notebook</name>
  <files>
    notebooks/quickstart.ipynb
  </files>
  <action>
1. Create notebooks/ directory if not exists:
   mkdir -p notebooks

2. Create notebooks/quickstart.ipynb as a Jupyter notebook (JSON format).

The notebook should demonstrate the complete workflow:
- Generate synthetic portfolio data
- Load and validate data
- Configure and run simulation
- Examine results
- Export to parquet

Structure with markdown cells explaining each step:

```
# Asset Optimization Quickstart

This notebook demonstrates the basic workflow for asset portfolio optimization.
You'll learn how to:
1. Create and load a portfolio
2. Configure a deterioration model
3. Run a multi-year simulation
4. Export results

## Setup

Install the package if needed: `pip install asset-optimization`

## 1. Generate Synthetic Portfolio

We'll create a sample water pipe portfolio with realistic characteristics.

[code cell - generates synthetic data with pd.DataFrame]

## 2. Load and Validate Portfolio

[code cell - Portfolio.from_dataframe(), check quality metrics]

## 3. Configure Deterioration Model

We use a Weibull model where each asset type has different shape/scale parameters.

[code cell - WeibullModel with params dict]

## 4. Run Simulation

Run a 10-year simulation tracking costs and failures.

[code cell - SimulationConfig, Simulator.run()]

## 5. Examine Results

[code cell - result.summary, total_cost(), total_failures()]

## 6. Export Results

[code cell - result.to_parquet()]

## Next Steps

- See `optimization.ipynb` for budget-constrained intervention selection
- See `visualization.ipynb` for charts and comparisons
```

Key code for synthetic data generation:

```python
import pandas as pd
import numpy as np
from datetime import date, timedelta

np.random.seed(42)

n_assets = 500
asset_types = ['Cast Iron', 'PVC', 'Ductile Iron']
conditions = ['Good', 'Fair', 'Poor']

# Generate realistic install dates (20-80 years old)
base_date = date(2024, 1, 1)
install_dates = [
    base_date - timedelta(days=int(np.random.uniform(20*365, 80*365)))
    for _ in range(n_assets)
]

data = pd.DataFrame({
    'asset_id': [f'PIPE-{i:04d}' for i in range(n_assets)],
    'install_date': install_dates,
    'asset_type': np.random.choice(asset_types, n_assets, p=[0.4, 0.35, 0.25]),
    'condition': np.random.choice(conditions, n_assets, p=[0.3, 0.5, 0.2]),
    'diameter': np.random.choice([6, 8, 12, 16], n_assets),
    'length_ft': np.random.uniform(100, 1000, n_assets).round(0),
})
```

Write as valid ipynb JSON with cell types, metadata, etc.
  </action>
  <verify>
    test -f /Users/henkgriffioen/code/asset-optimization/notebooks/quickstart.ipynb && python -c "import json; json.load(open('/Users/henkgriffioen/code/asset-optimization/notebooks/quickstart.ipynb'))" && echo "Valid notebook JSON"
  </verify>
  <done>
    - notebooks/quickstart.ipynb exists
    - Valid Jupyter notebook JSON format
    - Includes synthetic data generation
    - Tutorial-style with markdown explanations
  </done>
</task>

<task type="auto">
  <name>Task 2: Create optimization notebook</name>
  <files>
    notebooks/optimization.ipynb
  </files>
  <action>
Create notebooks/optimization.ipynb demonstrating optimization workflow:

Structure:
```
# Optimization Workflow

Learn how to select optimal interventions under budget constraints.

## Setup

[code cell - imports]

## 1. Create Portfolio and Model

[code cell - reuse synthetic data generation, load portfolio, create model]

## 2. Configure Optimizer

The optimizer uses a greedy algorithm to select high-value interventions.

[code cell - Optimizer with budget constraint]

## 3. Run Optimization

[code cell - optimizer.fit()]

## 4. Examine Selections

[code cell - result.selections, result.budget_summary]

## 5. Understand the Algorithm

The greedy algorithm:
1. Evaluates each asset's risk and intervention costs
2. Calculates cost-effectiveness for each option
3. Ranks by risk-to-cost ratio
4. Fills budget greedily

[code cell - show rankings, explain why certain assets selected]

## 6. Compare Scenarios

What if we had double the budget?

[code cell - run with 2x budget, compare_scenarios()]

## 7. Export Intervention Schedule

[code cell - result.to_parquet('schedule.parquet', format='detailed')]
```

Key code snippets:

```python
from asset_optimization import (
    Portfolio, WeibullModel, Optimizer, OptimizationResult,
    compare_scenarios, SimulationResult, SimulationConfig,
)

# Optimizer configuration
optimizer = Optimizer(
    budget=500_000,  # Annual budget
    strategy='greedy',
    min_risk_threshold=0.1,  # Only consider assets with >10% failure risk
)

# Run optimization
result = optimizer.fit(portfolio, model, interventions)

# View selections
print(f"Selected {len(result.selections)} interventions")
print(f"Budget utilization: {result.utilization_pct:.1f}%")
result.selections.head(10)
```

Write as valid ipynb JSON.
  </action>
  <verify>
    test -f /Users/henkgriffioen/code/asset-optimization/notebooks/optimization.ipynb && python -c "import json; json.load(open('/Users/henkgriffioen/code/asset-optimization/notebooks/optimization.ipynb'))" && echo "Valid notebook JSON"
  </verify>
  <done>
    - notebooks/optimization.ipynb exists
    - Valid Jupyter notebook JSON format
    - Demonstrates budget-constrained optimization
    - Shows scenario comparison with different budgets
  </done>
</task>

<task type="auto">
  <name>Task 3: Create visualization notebook</name>
  <files>
    notebooks/visualization.ipynb
  </files>
  <action>
Create notebooks/visualization.ipynb demonstrating all visualization features:

Structure:
```
# Visualization and Export

Learn how to create publication-quality charts and export results.

## Setup

[code cell - imports, set_sdk_theme()]

## 1. Create Sample Data

[code cell - create SimulationResult and OptimizationResult for visualization]

## 2. SDK Theme

All plots use a consistent professional theme.

[code cell - set_sdk_theme(), explain the theme]

## 3. Cost Over Time

[code cell - plot_cost_over_time(result)]

## 4. Failures by Year

[code cell - plot_failures_by_year(result)]

## 5. Risk Distribution

[code cell - plot_risk_distribution(opt_result.selections)]

## 6. Scenario Comparison

Compare optimized vs do-nothing baseline.

[code cell - compare(), plot_scenario_comparison()]

## 7. Customizing Charts

All plot functions return axes for customization.

[code cell - ax = plot_cost_over_time(result); ax.set_ylim(...)]

## 8. Exporting Results

### To Parquet

[code cell - to_parquet examples]

### Reading Exports

[code cell - pd.read_parquet(), show data]

## 9. Creating Multi-Panel Figures

[code cell - plt.subplots, multiple plots in one figure]
```

Key code snippets:

```python
from asset_optimization import (
    set_sdk_theme,
    plot_cost_over_time,
    plot_failures_by_year,
    plot_risk_distribution,
    plot_scenario_comparison,
    compare,
)
import matplotlib.pyplot as plt

# Apply SDK theme
set_sdk_theme()

# Cost over time
ax = plot_cost_over_time(sim_result)
plt.savefig('cost_chart.png', dpi=150, bbox_inches='tight')

# Multi-panel figure
fig, axes = plt.subplots(2, 2, figsize=(14, 10))
plot_cost_over_time(sim_result, ax=axes[0, 0])
plot_failures_by_year(sim_result, ax=axes[0, 1])
plot_risk_distribution(opt_result.selections, ax=axes[1, 0])
comparison = compare(sim_result, baseline='do_nothing')
plot_scenario_comparison(comparison, ax=axes[1, 1])
plt.tight_layout()
```

Write as valid ipynb JSON.
  </action>
  <verify>
    test -f /Users/henkgriffioen/code/asset-optimization/notebooks/visualization.ipynb && python -c "import json; json.load(open('/Users/henkgriffioen/code/asset-optimization/notebooks/visualization.ipynb'))" && echo "Valid notebook JSON"
  </verify>
  <done>
    - notebooks/visualization.ipynb exists
    - Valid Jupyter notebook JSON format
    - Demonstrates all 4 chart types
    - Shows customization and multi-panel figures
  </done>
</task>

</tasks>

<verification>
1. All 3 notebooks exist in notebooks/ directory
2. Each notebook is valid JSON (parseable by json.load)
3. Notebooks include synthetic data generation
4. Each notebook has markdown cells explaining concepts
</verification>

<success_criteria>
- DEVX-03: Jupyter notebook examples demonstrate end-to-end workflow
- DEVX-04 (partial): Documentation via docstrings + notebooks covers usage patterns
- Runnable: Notebooks include synthetic data, no external files needed
- Educational: Tutorial-style with explanatory markdown between code cells
</success_criteria>

<output>
After completion, create `.planning/phases/05-results-polish/05-05-SUMMARY.md`
</output>
